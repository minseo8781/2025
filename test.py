import streamlit as st
import pandas as pd
import random

# ------------------------------
# ì•± ê¸°ë³¸ ì„¤ì •
# ------------------------------
st.set_page_config(page_title="ğŸ ê±´ê°• ì‹ë‹¨ & ì¹¼ë¡œë¦¬ ê³„ì‚°ê¸°", page_icon="ğŸ¥—", layout="wide")
st.title("ğŸ¥— ê±´ê°•í•œ ì‹ë‹¨ & ì¹¼ë¡œë¦¬ ê³„ì‚° + ìš´ë™ ì¶”ì²œ ì•±")
st.write("ì˜¤ëŠ˜ ë¨¹ì€ ìŒì‹ì„ ì…ë ¥í•˜ë©´ ì¹¼ë¡œë¦¬ë¥¼ ê³„ì‚°í•˜ê³ , ë¶€ì¡±í•˜ê±°ë‚˜ ì´ˆê³¼í•œ ì¹¼ë¡œë¦¬ì— ë§ëŠ” ìš´ë™ì„ ì¶”ì²œí•©ë‹ˆë‹¤!")

# ------------------------------
# ìŒì‹ ì¹¼ë¡œë¦¬ ë°ì´í„° (í•œì‹ + ì–‘ì‹ + ê°„ì‹ + ìŒë£Œ)
# ------------------------------
food_calories = {
    # í•œì‹
    "ê¹€ë°¥": 300, "ë¼ë©´": 500, "ì¹˜í‚¨": 800, "í”¼ì": 700, "ì‚¼ê²¹ì‚´": 600,
    "ëœì¥ì°Œê°œ": 350, "ë¹„ë¹”ë°¥": 550, "ë¶ˆê³ ê¸°": 450, "ìˆœë‘ë¶€ì°Œê°œ": 400, "ì¹¼êµ­ìˆ˜": 480,
    "ë–¡ë³¶ì´": 400, "ì¡ì±„": 350, "ê¹€ì¹˜ì°Œê°œ": 380, "ê°ˆë¹„íƒ•": 600, "ì¡±ë°œ": 750,

    # ì–‘ì‹
    "í–„ë²„ê±°": 550, "ìŠ¤íŒŒê²Œí‹°": 600, "ìƒëŸ¬ë“œ": 150, "ìŠ¤í…Œì´í¬": 700, "ìƒŒë“œìœ„ì¹˜": 400,
    "ê°ìíŠ€ê¹€": 300, "í•«ë„ê·¸": 450, "ì¹˜ì¦ˆì¼€ì´í¬": 350, "íŒŒìŠ¤íƒ€": 500, "ë¦¬ì¡°ë˜": 550,

    # ê°„ì‹ & ë””ì €íŠ¸
    "ë°”ë‚˜ë‚˜": 90, "ì‚¬ê³¼": 60, "ë”¸ê¸°": 50, "ì´ˆì½œë¦¿": 200, "ì•„ì´ìŠ¤í¬ë¦¼": 250,
    "ë¹µ": 250, "ì¿ í‚¤": 180, "ë„ë„›": 270, "ë¨¸í•€": 300, "ë–¡": 220,

    # ìŒë£Œ
    "ìš°ìœ ": 120, "ì»¤í”¼": 50, "ì½œë¼": 140, "ì£¼ìŠ¤": 150, "ë²„ë¸”í‹°": 350,
    "ì—ë„ˆì§€ë“œë§í¬": 200, "ìŠ¤ë¬´ë””": 250
}

# ------------------------------
# ìŒì‹ ì„ íƒ
# ------------------------------
selected_foods = st.multiselect("ğŸ½ï¸ ì˜¤ëŠ˜ ë¨¹ì€ ìŒì‹ì„ ì„ íƒí•˜ì„¸ìš”", list(food_calories.keys()))
total_calories = sum([food_calories[food] for food in selected_foods])

st.subheader("ğŸ“Š ì˜¤ëŠ˜ì˜ ì„­ì·¨ ì¹¼ë¡œë¦¬")
st.metric(label="ì´ ì„­ì·¨ ì¹¼ë¡œë¦¬", value=f"{total_calories} kcal")

# ------------------------------
# í•˜ë£¨ ê¶Œì¥ ì¹¼ë¡œë¦¬ ì„¤ì •
# ------------------------------
gender = st.radio("ğŸ‘¤ ì„±ë³„ì„ ì„ íƒí•˜ì„¸ìš”", ["ë‚¨ì„±", "ì—¬ì„±"])
if gender == "ë‚¨ì„±":
    recommended_cal = 2500
else:
    recommended_cal = 2000

st.write(f"ğŸ‘‰ í•˜ë£¨ ê¶Œì¥ ì¹¼ë¡œë¦¬: **{recommended_cal} kcal**")

# ------------------------------
# ìš´ë™ ë°ì´í„°
# ------------------------------
exercise_list = [
    {"ìš´ë™": "ê±·ê¸° ğŸš¶", "ì¹¼ë¡œë¦¬ì†Œëª¨": 280},
    {"ìš´ë™": "ë‹¬ë¦¬ê¸° ğŸƒ", "ì¹¼ë¡œë¦¬ì†Œëª¨": 500},
    {"ìš´ë™": "ìì „ê±° ğŸš´", "ì¹¼ë¡œë¦¬ì†Œëª¨": 400},
    {"ìš´ë™": "ìˆ˜ì˜ ğŸŠ", "ì¹¼ë¡œë¦¬ì†Œëª¨": 600},
    {"ìš´ë™": "ì¤„ë„˜ê¸° ğŸ¤¾", "ì¹¼ë¡œë¦¬ì†Œëª¨": 450},
    {"ìš´ë™": "ìš”ê°€ ğŸ§˜", "ì¹¼ë¡œë¦¬ì†Œëª¨": 200}
]

# ------------------------------
# ì¹¼ë¡œë¦¬ ë¹„êµ ë° ìš´ë™ ì¶”ì²œ
# ------------------------------
st.subheader("ğŸ’ª ê²°ê³¼ ë¶„ì„")

if total_calories > recommended_cal:
    st.error("âš ï¸ ê¶Œì¥ ì¹¼ë¡œë¦¬ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤! ìš´ë™ì´ í•„ìš”í•´ìš”.")
    need_burn = total_calories - recommended_cal
    st.write(f"ğŸ”¥ ì¶”ê°€ë¡œ **{need_burn} kcal**ë¥¼ ì†Œëª¨í•´ì•¼ í•©ë‹ˆë‹¤.")

    # ìš´ë™ ì—¬ëŸ¬ ê°œ ì¶”ì²œ
    st.write("ì¶”ì²œ ìš´ë™ (ë¬´ì‘ìœ„ 3ê°œ):")
    selected_exercises = random.sample(exercise_list, 3)
    for ex in selected_exercises:
        st.write(f"- {ex['ìš´ë™']} : ì•½ {ex['ì¹¼ë¡œë¦¬ì†Œëª¨']} kcal ì†Œëª¨")

    # ì°¨íŠ¸ í‘œì‹œ
    df = pd.DataFrame(selected_exercises)
    st.bar_chart(df.set_index("ìš´ë™"))

elif total_calories < recommended_cal - 300:
    st.warning("ğŸ½ï¸ ê¶Œì¥ ì¹¼ë¡œë¦¬ë³´ë‹¤ ì ê²Œ ë¨¹ì—ˆìŠµë‹ˆë‹¤. ì˜ì–‘ì„ ë” ë³´ì¶©í•˜ì„¸ìš”!")
else:
    st.success("âœ… ì ì ˆí•œ ì¹¼ë¡œë¦¬ë¥¼ ì„­ì·¨í–ˆìŠµë‹ˆë‹¤! ê±´ê°•ì„ ìœ ì§€í•˜ì„¸ìš”.")

# ------------------------------
# í”¼ë“œë°± ì…ë ¥
# ------------------------------
st.subheader("ğŸ“ í”¼ë“œë°± ë‚¨ê¸°ê¸°")
feedback = st.text_area("ì•±ì— ëŒ€í•œ ì˜ê²¬ì„ ë‚¨ê²¨ì£¼ì„¸ìš”!")
if st.button("ì œì¶œ"):
    st.success("í”¼ë“œë°±ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ™")
